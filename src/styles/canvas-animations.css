/**
 * StickerNest v2 - Canvas Animations
 * Polish animations for canvas interactions
 */

/* ===========================================
 * WIDGET FRAME ANIMATIONS
 * =========================================== */

/* Widget selection glow pulse */
@keyframes sn-widget-select-pulse {
  0%, 100% {
    box-shadow: 0 0 0 2px var(--sn-accent-primary),
                0 0 8px rgba(139, 92, 246, 0.3);
  }
  50% {
    box-shadow: 0 0 0 2px var(--sn-accent-primary),
                0 0 16px rgba(139, 92, 246, 0.5);
  }
}

/* Widget hover lift */
@keyframes sn-widget-hover-lift {
  from {
    transform: translateY(0);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  }
  to {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
  }
}

/* Widget spawn/add animation */
@keyframes sn-widget-spawn {
  0% {
    opacity: 0;
    transform: scale(0.8) rotate(-3deg);
  }
  50% {
    transform: scale(1.03) rotate(0.5deg);
  }
  100% {
    opacity: 1;
    transform: scale(1) rotate(0deg);
  }
}

/* Widget delete animation */
@keyframes sn-widget-delete {
  0% {
    opacity: 1;
    transform: scale(1);
  }
  30% {
    transform: scale(1.05);
  }
  100% {
    opacity: 0;
    transform: scale(0.7) rotate(5deg);
  }
}

/* Resize handle hover pulse */
@keyframes sn-handle-pulse {
  0%, 100% {
    transform: scale(1);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
  }
  50% {
    transform: scale(1.15);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  }
}

/* ===========================================
 * PANEL ANIMATIONS
 * =========================================== */

/* Panel slide in from right */
@keyframes sn-panel-slide-right {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Panel slide in from left */
@keyframes sn-panel-slide-left {
  from {
    opacity: 0;
    transform: translateX(-100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Panel slide in from bottom */
@keyframes sn-panel-slide-up {
  from {
    opacity: 0;
    transform: translateY(100%);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Fade scale enter */
@keyframes sn-panel-fade-scale {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* ===========================================
 * TOOLBAR ANIMATIONS
 * =========================================== */

/* Toolbar button press ripple */
@keyframes sn-button-ripple {
  from {
    transform: scale(0);
    opacity: 0.5;
  }
  to {
    transform: scale(2.5);
    opacity: 0;
  }
}

/* Tool selection indicator */
@keyframes sn-tool-select {
  0% {
    transform: scale(0.9);
    opacity: 0;
  }
  50% {
    transform: scale(1.05);
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

/* ===========================================
 * MARQUEE SELECTION
 * =========================================== */

/* Marquee border dash animation */
@keyframes sn-marquee-dash {
  from {
    stroke-dashoffset: 0;
  }
  to {
    stroke-dashoffset: 16;
  }
}

/* ===========================================
 * CROP OVERLAY
 * =========================================== */

/* Crop overlay fade in */
@keyframes sn-crop-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* ===========================================
 * LAYER PANEL
 * =========================================== */

/* Layer item add */
@keyframes sn-layer-add {
  from {
    opacity: 0;
    transform: translateX(-20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateX(0) scale(1);
  }
}

/* Layer item reorder */
@keyframes sn-layer-reorder {
  from {
    background: var(--sn-accent-primary-20);
  }
  to {
    background: transparent;
  }
}

/* ===========================================
 * UTILITY CLASSES
 * =========================================== */

/* Widget frame with hover lift */
[data-widget-frame]:not([data-widget-docked="true"]) {
  transition:
    box-shadow var(--sn-duration-fast, 150ms) var(--sn-ease-out-expo, cubic-bezier(0.19, 1, 0.22, 1)),
    transform var(--sn-duration-fast, 150ms) var(--sn-ease-out-expo, cubic-bezier(0.19, 1, 0.22, 1));
}

/* Widget newly added */
.sn-widget-new {
  animation: sn-widget-spawn var(--sn-duration-slow, 400ms) var(--sn-ease-spring-smooth, cubic-bezier(0.175, 0.885, 0.32, 1.275));
}

/* Widget being deleted */
.sn-widget-deleting {
  animation: sn-widget-delete 250ms var(--sn-ease-out-expo, cubic-bezier(0.19, 1, 0.22, 1)) forwards;
  pointer-events: none;
}

/* Selected widget glow */
.sn-widget-selected {
  animation: sn-widget-select-pulse 2s ease-in-out infinite;
}

/* Panel animations */
.sn-panel-enter-right {
  animation: sn-panel-slide-right var(--sn-duration-normal, 250ms) var(--sn-ease-spring-smooth, cubic-bezier(0.175, 0.885, 0.32, 1.275));
}

.sn-panel-enter-left {
  animation: sn-panel-slide-left var(--sn-duration-normal, 250ms) var(--sn-ease-spring-smooth, cubic-bezier(0.175, 0.885, 0.32, 1.275));
}

.sn-panel-enter-up {
  animation: sn-panel-slide-up var(--sn-duration-normal, 250ms) var(--sn-ease-spring-smooth, cubic-bezier(0.175, 0.885, 0.32, 1.275));
}

.sn-panel-enter-fade {
  animation: sn-panel-fade-scale var(--sn-duration-normal, 250ms) var(--sn-ease-spring-gentle, cubic-bezier(0.25, 0.46, 0.45, 0.94));
}

/* Resize handle with hover effect */
[data-resize-handle] {
  transition:
    transform var(--sn-duration-fast, 150ms) var(--sn-ease-spring-snappy, cubic-bezier(0.34, 1.56, 0.64, 1)),
    box-shadow var(--sn-duration-fast, 150ms) ease-out,
    background var(--sn-duration-fast, 150ms) ease-out;
}

[data-resize-handle]:hover {
  transform: scale(1.2);
  box-shadow: 0 2px 8px rgba(139, 92, 246, 0.4);
  background: var(--sn-accent-hover, #7c3aed) !important;
}

/* Rotation handle with hover */
.sn-rotation-handle {
  transition:
    transform var(--sn-duration-fast, 150ms) var(--sn-ease-spring-snappy, cubic-bezier(0.34, 1.56, 0.64, 1)),
    box-shadow var(--sn-duration-fast, 150ms) ease-out;
}

.sn-rotation-handle:hover {
  transform: translateX(-50%) scale(1.25);
  box-shadow: 0 2px 12px rgba(16, 185, 129, 0.5);
}

/* Marquee selection animated border */
[data-marquee-selection] {
  animation: sn-marquee-dash 0.5s linear infinite;
  background-image: repeating-linear-gradient(
    90deg,
    var(--sn-accent-primary, #8b5cf6),
    var(--sn-accent-primary, #8b5cf6) 4px,
    transparent 4px,
    transparent 8px
  );
  background-size: 8px 2px;
  background-position: 0 0;
  background-repeat: repeat-x;
}

/* Layer panel item animation */
.sn-layer-item {
  transition:
    background var(--sn-duration-fast, 150ms) ease-out,
    transform var(--sn-duration-fast, 150ms) var(--sn-ease-out-expo, cubic-bezier(0.19, 1, 0.22, 1)),
    border-color var(--sn-duration-fast, 150ms) ease-out;
}

.sn-layer-item:hover {
  background: var(--sn-glass-bg-light, rgba(255, 255, 255, 0.08));
}

.sn-layer-item.sn-layer-item-new {
  animation: sn-layer-add var(--sn-duration-normal, 250ms) var(--sn-ease-spring-smooth, cubic-bezier(0.175, 0.885, 0.32, 1.275));
}

.sn-layer-item.sn-layer-item-moved {
  animation: sn-layer-reorder var(--sn-duration-slow, 400ms) ease-out;
}

/* Crop handles */
.sn-crop-overlay {
  animation: sn-crop-fade-in var(--sn-duration-fast, 150ms) ease-out;
}

/* Tool button selection */
.sn-tool-button.sn-tool-active::after {
  animation: sn-tool-select var(--sn-duration-fast, 150ms) var(--sn-ease-spring-snappy, cubic-bezier(0.34, 1.56, 0.64, 1));
}

/* Input focus animation */
.sn-input-animated {
  transition:
    border-color var(--sn-duration-fast, 150ms) ease-out,
    box-shadow var(--sn-duration-fast, 150ms) ease-out;
}

.sn-input-animated:focus {
  border-color: var(--sn-accent-primary, #8b5cf6);
  box-shadow: 0 0 0 3px var(--sn-accent-primary-20, rgba(139, 92, 246, 0.2));
}

/* Dropdown menu enter */
.sn-dropdown-enter {
  animation: sn-panel-fade-scale var(--sn-duration-fast, 150ms) var(--sn-ease-spring-snappy, cubic-bezier(0.34, 1.56, 0.64, 1));
  transform-origin: top center;
}

/* Toast notification slide */
.sn-toast-enter {
  animation: sn-slide-up-spring var(--sn-duration-normal, 250ms) var(--sn-ease-spring-smooth, cubic-bezier(0.175, 0.885, 0.32, 1.275));
}

/* ===========================================
 * REDUCED MOTION SUPPORT
 * =========================================== */

@media (prefers-reduced-motion: reduce) {
  [data-widget-frame],
  [data-resize-handle],
  .sn-rotation-handle,
  .sn-layer-item,
  .sn-input-animated {
    transition: none !important;
  }

  .sn-widget-new,
  .sn-widget-deleting,
  .sn-widget-selected,
  .sn-panel-enter-right,
  .sn-panel-enter-left,
  .sn-panel-enter-up,
  .sn-panel-enter-fade,
  .sn-layer-item-new,
  .sn-layer-item-moved,
  .sn-crop-overlay,
  .sn-dropdown-enter,
  .sn-toast-enter,
  [data-marquee-selection] {
    animation: none !important;
  }
}
